import{a as fe,b as he}from"./chunk-C6OSBDEH.js";import{a as ye,b as ke,c as I,d as xe,f as Ce}from"./chunk-6W4WSXD2.js";import{C as a,Ea as X,F as M,Fa as Z,Ga as ee,H as B,I as D,Ia as f,Ka as te,La as ne,M as K,Ma as z,Na as oe,O as k,Ob as le,Qb as me,S as x,Ta as P,Tb as de,Ua as d,V as l,Va as ie,Vb as ge,_ as s,_a as re,_b as be,bc as ve,da as O,e as q,ea as g,fb as ae,g as F,gb as j,ib as se,j as V,ja as W,kc as Se,la as m,lb as pe,nb as ue,p as $,pa as Q,ra as Y,rb as ce,sa as H,t as y,ta as p,u as N,ua as u,va as b,wa as J,x as R,y as U,ya as G,za as C}from"./chunk-DLOOSL53.js";var A={googleBooksApi:"https://www.googleapis.com/books/v1",googleBooksApiKey:"AIzaSyAKuxTxRnSr0Jtv_9RY42KmaUEsKIfd0RQ"};var h=class n{http=a(re);BASE_URL=A.googleBooksApi;API_KEY=A.googleBooksApiKey;fetchBooksFromApi(e){return e.searchInput.length>=1?this.http.get(`${this.BASE_URL}/volumes?q=${e.searchInput}&startIndex=${e.startIndex}&maxResults=${e.maxResult}&key=${this.API_KEY}`):F({totalItems:0,kind:""})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})};var w=class n{booksService=a(h);total=x.required();pageSize=O.required();pageIndex=O.required();pageSizeOptions=[5,10];onChangePage(e){this.pageSize.set(e.pageSize),this.pageIndex.set(e.pageIndex+1)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=g({type:n,selectors:[["app-paginator"]],inputs:{total:[1,"total"],pageSize:[1,"pageSize"],pageIndex:[1,"pageIndex"]},outputs:{pageSize:"pageSizeChange",pageIndex:"pageIndexChange"},decls:2,vars:4,consts:[[1,"results-grid-container"],["aria-label","Select page",3,"page","length","pageSize","pageIndex","pageSizeOptions"]],template:function(t,o){t&1&&(p(0,"div",0)(1,"mat-paginator",1),G("page",function(r){return o.onChangePage(r)}),u()()),t&2&&(s(),m("length",o.total())("pageSize",o.pageSize())("pageIndex",o.pageIndex()-1)("pageSizeOptions",o.pageSizeOptions))},dependencies:[xe,I],encapsulation:2})};function v(n,e){!e?.injector&&M(v);let t=e?.injector??a(K),o=new q(1),i=ie(()=>{let r;try{r=n()}catch(S){P(()=>o.error(S));return}P(()=>o.next(r))},{injector:t,manualCleanup:!0});return t.get(k).onDestroy(()=>{i.destroy(),o.complete()}),o.asObservable()}function L(n,e){let t=!e?.manualCleanup;t&&!e?.injector&&M(L);let o=t?e?.injector?.get(k)??a(k):null,i=_e(e?.equal),r;e?.requireSync?r=l({kind:0},{equal:i}):r=l({kind:1,value:e?.initialValue},{equal:i});let S,T=n.subscribe({next:c=>r.set({kind:1,value:c}),error:c=>{if(e?.rejectErrors)throw c;r.set({kind:2,error:c})},complete:()=>{S?.()}});if(e?.requireSync&&r().kind===0)throw new R(601,!1);return S=o?.onDestroy(T.unsubscribe.bind(T)),d(()=>{let c=r();switch(c.kind){case 1:return c.value;case 2:throw c.error;case 0:throw new R(601,!1)}},{equal:e?.equal})}function _e(n=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&n(e.value,t.value)}var Re=(n,e)=>e.id;function Me(n,e){if(n&1&&b(0,"app-book-card",1),n&2){let t=e.$implicit;m("book",t.volumeInfo)("id",t.id)}}function Be(n,e){if(n&1){let t=J();p(0,"div",2)(1,"app-paginator",3),oe("pageIndexChange",function(i){B(t);let r=C();return z(r.pageIndex,i)||(r.pageIndex=i),D(i)})("pageSizeChange",function(i){B(t);let r=C();return z(r.pageSize,i)||(r.pageSize=i),D(i)}),u()()}if(n&2){let t=C();s(),m("total",t.totalBooks()),ne("pageIndex",t.pageIndex)("pageSize",t.pageSize)}}function De(n,e){n&1&&(p(0,"p"),f(1,"No results found... Try again!"),u())}var _=class n{booksService=a(h);paginator;totalBooks=d(()=>this.searchResultsSignal()?.totalItems??0);userInput=x();userInputSignal=d(()=>{let e=this.userInput();return e?e():""});pageIndex=l(1);pageSize=l(10);inputValue$=v(this.userInputSignal);pageIndex$=v(this.pageIndex);pageSize$=v(this.pageSize);finalSearchValue$=V([this.inputValue$.pipe($(300)),this.pageIndex$,this.pageSize$]).pipe(y([this.userInputSignal(),this.pageIndex(),this.pageSize()]));searchResults$=this.finalSearchValue$.pipe(N(([e,t,o])=>{let i={searchInput:e,startIndex:(t-1)*o,maxResult:o};return this.booksService.fetchBooksFromApi(i)}));searchResultsSignal=L(this.searchResults$);books=d(()=>(this.searchResultsSignal(),this.searchResultsSignal()?.items));noResult=d(()=>{let e=this.searchResultsSignal();return e?.totalItems==0&&e?.kind=="books#volumes"});static \u0275fac=function(t){return new(t||n)};static \u0275cmp=g({type:n,selectors:[["app-book-list"]],viewQuery:function(t,o){if(t&1&&X(I,5),t&2){let i;Z(i=ee())&&(o.paginator=i.first)}},inputs:{userInput:[1,"userInput"]},decls:5,vars:1,consts:[[1,"results-grid-container"],[1,"grid-item",3,"book","id"],[1,"paginator-wrapper"],[3,"pageIndexChange","pageSizeChange","total","pageIndex","pageSize"]],template:function(t,o){if(t&1&&(p(0,"div",0),Y(1,Me,1,2,"app-book-card",1,Re),W(3,Be,2,3,"div",2)(4,De,2,0,"p"),u()),t&2){let i;s(),H(o.books()),s(2),Q((i=o.books())!=null&&i.length?3:o.noResult()?4:-1)}},dependencies:[w,Ce],styles:[".results-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.5rem;padding:1.5rem;margin:0 auto;justify-items:center}.grid-item[_ngcontent-%COMP%]{width:100%;height:100%;max-width:240px;display:flex}.paginator-wrapper[_ngcontent-%COMP%]{grid-column:1 / -1;display:flex;justify-content:center;margin-top:1.5rem}"]})};var we=class n{userService=a(Se);username=this.userService.username;searchControl=new pe("",{validators:[j.required,j.maxLength(20)],nonNullable:!0});userInput=l("");ngOnInit(){this.searchControl.valueChanges.pipe(y(this.searchControl.value)).subscribe(e=>{this.userInput.set(e)})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=g({type:n,selectors:[["app-search"]],decls:12,vars:3,consts:[[1,"header"],[1,"search-bar"],["appearance","outline","color","accent",1,"search-field"],["matInput","","type","text","placeholder","Type title, author, or keyword","aria-label","Book search input",3,"formControl"],["mat-icon-button","","matSuffix","","aria-label","Search"],[3,"userInput"]],template:function(t,o){t&1&&(p(0,"header",0)(1,"h2"),f(2),u()(),p(3,"div",1)(4,"mat-form-field",2)(5,"mat-label"),f(6,"Search for books"),u(),b(7,"input",3),p(8,"button",4)(9,"mat-icon"),f(10,"search"),u()()()(),b(11,"app-book-list",5)),t&2&&(s(2),te("Hi ",o.username(),"! Let's search for your next book \u{1F4DA}"),s(5),m("formControl",o.searchControl),s(4),m("userInput",o.userInput))},dependencies:[he,fe,de,le,me,ge,ve,be,ce,ae,se,ue,ke,ye,_],styles:[".header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center;margin-bottom:2rem;font-size:1.6rem;color:#6b3fa0;font-weight:600;width:100%}.search-bar[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin:1rem auto 2rem;width:90%}.search-field[_ngcontent-%COMP%]{width:100%;font-size:1.1rem}"]})};export{we as SearchComponent};
